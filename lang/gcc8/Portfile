# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem                              1.0
PortGroup           gcc_build           1.0
PortGroup           xcode_workaround    1.0

name                gcc8
version             8.5.0
subport ${name}     { revision 2 }
subport lib${name}  { revision 1 }
epoch               5

platforms           {darwin >= 10 < 15}

checksums           rmd160  e7f3dedec67864006bf9f7e358817ce713b4476e \
                    sha256  d308841a511bb830a6100397b0042db24ce11f642dab6ea6ee44842e5325ed50 \
                    size    63841008

patchfiles          patch-fix-libgccjit-soname

if { ${os.major} >= 10 } {
    # fix no-pie clang bug bootstrapping gcc on i386
    # see https://trac.macports.org/ticket/63161
    patchfiles.i386-append  patch-gcc10-i686-clang-bootstrap-fix.diff
}

# see https://trac.macports.org/ticket/29067
# see https://trac.macports.org/ticket/29104
# see https://trac.macports.org/ticket/47996
compiler.blacklist-append   gcc-4.0 {llvm-gcc-4.2 < 2336.1} {clang < 300}
# on 10.6.8 building with the system gcc compilers leads to bootstrap comparison failures
platform darwin 10 {
    compiler.blacklist-append *gcc-3.* *gcc-4.*
}

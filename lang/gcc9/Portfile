# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4

PortSystem                              1.0
PortGroup           gcc_build           1.0
PortGroup           xcode_workaround    1.0

name                gcc9
version             9.5.0
subport ${name}     { revision 1 }
subport lib${name}  { revision 2 }
epoch               3

platforms           {darwin >= 10 < 15}

checksums           rmd160  2ba36108599ceee93931722d98e0d5280037b05c \
                    sha256  27769f64ef1d4cd5e2be8682c0c93f9887983e6cfd1a927ce5a0a2915a95cf8f \
                    size    72462752

libgcc.keep         libasan.5.dylib \
                    libgcc_ext.10.4.dylib \
                    libgcc_ext.10.5.dylib
libgcc.depends_lib

patchfiles          patch-fix-libgccjit-soname \
                    patch-darwin21-support.diff

if { ${os.platform} eq "darwin" && ${os.major} > 19 } {
    # https://gcc.gnu.org/bugzilla/show_bug.cgi?id=92061
    patchfiles-append   patch-genconditions.diff
}

if { ${os.major} >= 10 } {
    # fix no-pie clang bug bootstrapping gcc on i386
    # see https://trac.macports.org/ticket/63161
    patchfiles.i386-append  patch-gcc10-i686-clang-bootstrap-fix.diff
}

# see https://trac.macports.org/ticket/58493
# see https://trac.macports.org/ticket/65415
compiler.blacklist-append   {clang < 800} gcc-4.0 *gcc-4.2 {macports-clang-3.[4-7]} {macports-clang-1[2-9]}
